geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Spearman \n Correlation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1),
name="Spearman \n Correlation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1),
name="Spearman \n Correlation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1),
name="Spearman \n Correlation") +
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1),
name="Spearman \n Correlation") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "black", high = "black", mid = "white",
midpoint = 0, limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none")+
coord_fixed() +
geom_text( color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.1))
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none") +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1))
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none") +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("")
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none") +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("") +
ggtitle("Heatmap to visualize all correlations of the dataset")
#Make heatmap and save it to the plots folder
ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("") +
ggtitle("Heatmap to visualize all correlations of the dataset") +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none")
#Make heatmap and save it to the plots folder
ggheatmap<-ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("") +
ggtitle("Heatmap to visualize all correlations of the dataset") +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none")
ggsave("..//plots//heatmap.jpg", gghheatmap)
ggsave("..//plots//heatmap.jpg", ggheatmap)
?ggsave()
ggsave("..//plots//heatmap.jpg",
width = 10.24,
height = 10.16,
ggheatmap)
#check correlation with cohens interpretation criteria
yxcorrelation[which(cor < 0)]
# correlations higher than 0.5
yxcorrelation[which(cor > 0.5 || cor < 0.5)]
# correlations higher than 0.5
yxcorrelation[which(cor > 0.5 || cor < 0.5)]
# correlations higher than 0.5
yxcorrelation[which(cor > 0.5 | cor < 0.5)]
# correlations higher than 0.5
yxcorrelation[which(cor > 0.5 | cor < -0.5)]
# correlations between 0.3 and 0.5
yxcorrelation[which(cor>0.3 & cor<0.5 | cor < -0.3 & cor > -0.5)]
# correlations between 0.1 and 0.3
yxcorrelation[which(cor > 0.1 & cor < 0.3 | cor < -0.1 & cor > -0.3)]
# correlations between 0.3 and 0.5
yxcorrelation[which(cor>0.3 & cor<0.5 | cor < -0.3 & cor > -0.5)]
# correlations higher than 0.5
yxcorrelation[which(cor > 0.5 | cor < -0.5)]
# items not associated with criterion
yxcorrelation[which(cor < 0.1 & cor > -0.1)]
##Heatmap
head(X)
# items not associated with criterion
yxcorrelation[which(cor < 0.1 & cor > -0.1)]
?ifelse()
X0_care<-X
for (i in 1:length(X)) {
X0_care[,i]<-ifelse(X0_care[,i] == 0, NA, X0_care[,i])
}
head(X)
head(X0_care)
head(X0_care)
View(X0_care)
Xnozero<-X
for (i in 1:length(X)) {
Xnozero[,i]<-ifelse(Xnozero[,i] == 0, NA, Xnozero[,i])
}
head(Xnozero)
yxcorrelation<-list()
for(i in 1:(length(Xnozero)-1)){
yxcorrelation[[i]]<-data.table(y = "satisfaction",
x = names(Xnozero)[i],
cor = cor(y = Xnozero$satisfaction,
x = Xnozero[,i],
method = "spearman"))
}
#make list a data.table
yxcorrelation<-rbindlist(yxcorrelation)
View(yxcorrelation)
Xnozero<-X
for (i in 1:length(X)) {
Xnozero[,i]<-ifelse(Xnozero[,i] == 0, NA, Xnozero[,i])
}
yxcorrelation<-list()
for(i in 1:(length(Xnozero)-1)){
yxcorrelation[[i]]<-data.table(y = "satisfaction",
x = names(Xnozero)[i],
cor = cor(y = Xnozero$satisfaction,
x = Xnozero[,i],
method = "spearman",
na.rm=TRUE))
}
?cor
#prepare correlationmatrix
cormat<-round(cor(Xnozero, method = "spearman"),2)
cormat<-melt(cormat)
#Make heatmap
ggheatmap<-ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("") +
ggtitle("Heatmap to visualize all correlations of the dataset") +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none")
##save heatmap to the plots folder
ggsave("..//plots//heatmap.jpg",
width = 10.24,
height = 10.16,
ggheatmap)
#prepare correlationmatrix
cormat<-round(cor(Xnozero, method = "spearman", use = "complete.obs"),2)
cormat<-melt(cormat)
#Make heatmap
ggheatmap<-ggplot(data = cormat,
aes(x = Var1,
y = Var2,
fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "black", #negative coefficients
high = "black", #positive coefficients
mid = "white", #coefficients close to 0
midpoint = 0,
limit = c(-1,1),
name="Spearman \n Correlation") +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black",
size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
coord_fixed() +
geom_text(aes(y = Var2,
x = Var1,
label = value),
color = "black", size = 3) +
guides(fill = guide_colorbar(barwidth = 7,
barheight = 1,
title.position = "top",
title.hjust = 0.1)) +
ylab("") +
xlab("") +
ggtitle("Heatmap to visualize all correlations of the dataset") +
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
hjust = 1),
legend.position = "none")
##save heatmap to the plots folder
ggsave("..//plots//heatmap.jpg",
width = 10.24,
height = 10.16,
ggheatmap)
yxcorrelation
#Calculate Spearman correlations from between the independent variables
#and the dependent variable (NAs are not used for correlation)
yxcorrelation<-list()
for(i in 1:(length(Xnozero)-1)){
yxcorrelation[[i]]<-data.table(y = "satisfaction",
x = names(Xnozero)[i],
cor = cor(y = Xnozero$satisfaction,
x = Xnozero[,i],
method = "spearman",
use = "complete.obs"))
}
#make list a data.table
yxcorrelation<-rbindlist(yxcorrelation)
yxcorrelation
#Calculate Spearman correlations from between the independent variables
#and the dependent variable (NAs are not used for correlation)
yxcorrelation<-list()
for(i in 1:(length(X)-1)){
yxcorrelation[[i]]<-data.table(y = "satisfaction",
x = names(X)[i],
cor = cor(y = X$satisfaction,
x = X[,i],
method = "spearman",
use = "complete.obs"))
}
#make list a data.table
yxcorrelation<-rbindlist(yxcorrelation)
yxcorrelation
